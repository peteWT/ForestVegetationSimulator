# Subject: FIA National Scale Volume Biomass (NSVB) Updates

**Name:** Daniel S Wagner

**Date:** 06/24/2024 - 08/25/2025

**Variants Affected:** All

## Elements

### I. Addition of merchantable cubic foot volume arrays

In order to retrieve total biomass and carbon values from National Volume Biomass Library (NVEL)
NSVB computations in eastern variants, modification to the FVS cubic foot volume storage arrays was necessary.  

FVS has been modified to track three (3) cubic foot volume metrics per tree, standardizing cubic volume output for every variant.

* Total cubic foot volume (`CFV(MAXTRE)`)
* Total merchantable cubic foot volume (`MCFV(MAXTRE)`)
* Merchantable sawlog cubic foot volume (`SCFV(MAXTRE)`)

This update replaces the need for WK1 array to be used to track merchantable volume, and allows for user customizable
sawlog cubic foot merchantability standards that can differ from the total merchantable cubic foot volume specifications,
and from the board foot merchantability specifications.  This is accomplished through additional arrays tracking sawlog cubic foot
merchantability specifications.

* Sawlog cubic foot minimum diameter (`SCFMIND(MAXSP)`)
* Sawlog cubic foot minimum top diameter (`SCFTOPD(MAXSP)`)
* Sawlog cubic foot volume stump height (`SCFSTMP(MAXSP)`)

Totals for cubic volumes stored in:

* `OUTCOM.OMCCUR`: Current merchantable cubic volume with distribution (`OUTCOM.IOSPMC`, `OUTCOM.OSPMC`)
* `OUTCOM.OSCCUR`: Current sawlog cubic volume with distribution (`OUTCOM.IOSPSC`, `OUTCOM.OSPSC`)

#### I. Impact on users

##### Output Standardization

Tabular output will report three (3) measures of cubic foot volume.  There will no longer be a difference between
eastern and western variants in terms of base model tabular output (removal of *_East tables)

##### Update to MINHARV Keyword

MINHARV keyword has been restructured and expanded to the following:

* Field 1: Year or Cycle
* Field 2: Minimum acceptable basal area removal
* Field 3: Minimum acceptable total cubic foot volume removal
* Field 4: Minimum acceptable merchantable cubic foot volume removal
* Field 5: Minimum acceptable sawlog cubic foot volume removal
* Field 6: Minimum acceptable board foot volume removal

##### Update to VOLUME Keyword

* Field 8: Sawlog cubic minimum DBH
* Field 9: Sawlog cubic minimum top diameter
* Field 10: Sawlog cubic stump height

#### I. Files Modified

**ak\estab.f** - Added initialization of `MCFV(ITRN) (=0)` and `SCFV(ITRN) (=0)` based on existing occurrences and locations of `CFV(ITRN)` initialization in code

**..\grinit.f** - Initialization of the following arrays to variant specific defaults consistent with variants board foot specifications:

* `SCFMIND`
* `SCFTOPD`
* `SCFSTMP`

**..\sitset.f** - Sets following arrays to match board foot volume specifications, if not set in `initre.f`:

* `SCFMIND(ISPC) = BFMIND(ISPC)`
* `SCFTOPD(ISPC) = BFTOPD(ISPC)`

**base\apisubs.f** -

* Removal of WK1 "set" and "get", and addition of `mcfv` and `scfv` "set" and "get" to subroutine `fvsTreeAttr`
* Expansion of fvsSummary subroutine to include `ScFt` and `RScFt`
* Initialization of `mcfv` and `scfv` to `0` in subroutine `fvsAddTrees`
* Updated Wiki

**base\compres.f** - Added functionality for `MCFV` and `SCFV` arrays to function in compress subroutine using `CFV` as basis for subroutine modification

**base\ecovols.f** - Replace `WK1` array with `MCFV` array in `CVOLC` DBH Class summation

**base\fvs.f** - Added functionality to compute percentile distribution for merchantable and sawlog cubic foot volumes, and storing results into `OMCCUR` and `OSCCUR`.  Added functionality to compute total merchantable cubic foot and sawlog cubic foot volumes

**base\gradd.f** - Added functionality to compute percentile distribution for merchantable and sawlog cubic foot volumes, and storing results into `OMCCUR` and `OSCCUR`
for use in computing accretion

**base\grincr.f** - Added logic for storing previous cycle merchantable and sawlog cubic foot volumes, and removing reference to WK1 array

**base\tremov.f** - Added `MCFV` and `SCFV` logic to tree move subroutine

**base\triple.f** - Added logic to handle `MCFV` and `SCFV` in tripling subroutine

**base\volkey.f** - Inclusion of logic for conditionally assigned sawlog cubic volume specifications (`SCFMIND`, `SCFTOPD`, `SCFSTMP`)

**common\ARRAYS.F77** - Added the following arrays for tracking cubic volume

* `MCFV(MAXTRE)`
* `SCFV(MAXTRE)`

**common\CONTRL.F77** - Added the following arrays for tracking cubic volume specifications

* `SCFMIND(MAXSP)`
* `SCFTOPD(MAXSP)`
* `SCFSTMP(MAXSP)`
* `SCFMIN` Real variable used in cuts for minimum harvest definitions from MINHARV

**common\SRDSTK.F77** - Addition of `PSCFV(MAXTRE)` to track previous cycle sawlog cubic volumes

**..\esuckr.f (all variants)** initialization of `MCFV` and `SCFV` to zero for sprouts

**dbsqlite\dbsatrtls.f** -

* Added reporting of `MCFV` and `SCFV` to FVS_ATRTList
* Added logic to add `SCuFt` column to treelist table in event treelist table existed prior to NSVB update

**dbsqlite\dbscuts.f** -

* Added logic for reporting `MCFV` and `SCFV`
* Added logic to add `SCuFt` column to treelist table in event treelist table existed prior to NSVB update

**dbsqlite\dbstrls.f** -

* Added logic for reporting `MCFV` and `SCFV` to treelist
* Added logic to add `SCuFt` column to treelist table in event treelist table existed prior to NSVB update

**estab\estab.f ls\estab.f strp\estab.f** - Added initialization of `MCFV` and `SCFV` to zero for new trees

**ie\cftopk.f  kt\cftopk.f** - Added logic for topkill to affect `MCFV` and `SCFV`, using existing code as template for `SCFV` reduction

**ie\vols.f organon\vols.f vls\vols.f** -

* Replaced use of `WK1` array with `MCFV`
* Logic to save merchantable and sawlog cubic volume volumes to `MCFV` and `SCFV`
* Stores species specific volumes to `SPCMC(ISPC,IM)` and `SPCSC(ISPC,IM)`
* Added logic for dealing with defect for `SCFV` and combining logic dealing with defect from eastern variants into ie/vols.f in effort to reduce code across files (targeting eventual removal of vls/vols.f)

**pg\getstd.f pg\putstd.f** - Added variables to put/get routines for STOP/START features

* `MCFV`
* `SCFV`
* `OMCCUR`
* `OSCCUR`
* `OSPMC`
* `OSPSC`

**vbase\cuts.f** - Added arrays to cut subroutine

**vbase\disply.f** - Added functionality to print totals (`OMCCUR`, (`OSPMC`, `IOSPMC`)`OSCCUR`, (`OSPSC`, `IOSPSC`))

**vbase\fvsstd.f** - Added `MCFV`, `SCFV` to FVS_Stand PostProcessor output

**vbase\initre.f** - Added sawlog cubic foot to MINHARV and VOLUME

**vbase\prtrls.f** - Added `MCFV`, `SCFV` to treelist output

**vdbsqlite\dbssumry.f** - Added logic for totals (`OMCCUR`, `OSCCUR`)

**vbase\prtrls.f**  

**vbase\sumout.f**  

**vdbsqlite\dbssumry.f**  

### II. FIA NSVB Functionality

The National Scale Volume Biomass (NSVB) implementation in NVEL requires a few modifications to the standard FVS default workflow.  NVEL NSVB computation requires the following changes:

* A unique volume equation number of the general format `NVBECODSPP`, where `ECOD` is the ecological division (ie '0240' or 'M240') and `SPP` is the 3 character FIA species code or species group code.

* To maintain volume consistency between FIA and FVS, the volume specifications within FVS need to match FIA and be prevented from being changed by the VOLUME keyword

* Ecoregion, currently read from the FVS_StandInit table and used to set other internal variables such as habitat type, needs to be tracked for NSVB volume equation computation.  This has been accomplished in two ways:

  * A new common block variable has been added to save this information
  * The STDINFO keyword field list has been expanded to allow the EcoDivision to be input in field 8.

* Some FIA NSVB equation numbers can be appended with a 'P' to indicate the stand is managed as a plantation.  The STDINFO keyword field list has been expanded to allow the identification of a stands origin in field 9.  This is a new variable, specific to FIAVBC usage, and is stored as `ISTDORG` in common\PLOT.F77 as an integer.  Default of '0' for a natural stand, '1' for a plantation.  This was originally concieved as being based on the 'MANAGED' keyword, but was changed to a stand alone variable as the 'MANAGED' inpacts some growth equations as well.

* To maintain consistancy with FIA processes for dealing with cull and defect the following changes were also made:
  * Existing FVS cubic foot top kill methodolgies have been bypassed when FIAVBC is in use or an equation begining with 'NVB' is being used
  * Use of defect methods, either via keywords or through damage input from StandInit or PlotInit tables has been blocked when FIAVBC is in use.

#### II. Impact on users

Use of FIAVBC will prevent users from modifying cubic foot merchantability specifications, apply user specified defect via keywords, or damage category inputs.

Additional keywords are required to obtain FIAVBC Summary or treelist tables.

#### II. Files Modified

**..\grinit.f** - Initialization of logical flag `LFIANVB` to `.FALSE.`, initialization of `ISTDORG`

**..\sitset.f** - Added NVSB volume equation logic to section setting VEQNNC number.

```FORTRAN
      ELSE IF((METHC(ISPC).EQ.10).AND.
     &  (VEQNNC(ISPC).EQ.'          ')) THEN
        CALL NVBEQ(IFIASP,VOLEQ)
        VEQNNC(ISPC)=VOLEQ
```

**base\errgro.f** - Added warnings for notifying users of attempts to modify cubic volume specifications or cubic volume defects when FIAVBC is active

**base\kewrds.f** - Added keyword `FIAVBC` to position 147 of `TABLE` array

**base\volkey.f** - Added logic to prevent condition modification of cubic volume or defect when FIAVBC is active

**common\CONTRL.F77** - Added logicial LFIANVB for testing status of FIAVBC request (on\off)

**common\PLOT.F77** - Added CHAR(11) variable `ECOREG`.  Added Integer `ISTDORG`

**vbase\initre.f** -

* Added assignment of common block variable `ECOREG` based on field 8, and `ISTDORG` based on field 9 of the STDINFO keyword.  Added variables to STDINFO reporting output.

* Added check for `LFIANVB` flag to VOLUME keyword logic to prevent merchantability specifications from being changed if FIA NSVB methods have been requested.  This will also print a notice to the user in the .out file

```FORTRAN
      IF(LFIANVB) THEN
        IF(LKECHO)WRITE(JOSTND,4531) KEYWRD
 4531    FORMAT (/A8'   KEYWORD REQUEST HAS BEEN RECONIGIZED BUT HAS '
     >        'BEEN DEACTIVIATED BY A PREVIOUS CALL TO USE FIA NSVB ' 
     >        'FOR COMPUTATION OF CUBIC FOOT VOLUMES')
        GOTO 10 
```

* Added number `14700` to index 147 of `GO TO` statement

* Added logic to set cubic volume method for FIANSVB, keyword **FIANSVB**,
process option number 14700

```FORTRAN
C
C  ==========  OPTION NUMBER 147: FIANSVB  ==========================FIANSVB
C
14700 CONTINUE

      LFIANVB = .TRUE.
      DO 14710 ISPC=1,MAXSP
        METHC(ISPC) = 10
               READ(FIAJSP(ISPC), '(I3)') IFIACODE

        IF(IFIACODE.GT.0 .OR. 
     &    (VARACD.EQ.'AK'.AND.JSP(ISPC).EQ.'LS')) THEN 
          ! Minimum merch for both softwood and hardwood
          DBHMIN(ISPC) = 5
          TOPD(ISPC) = 4
          STMP(ISPC) = 1
          SCFSTMP = 1
          IF(IFIACODE.LT.300) THEN              ! Softwood sawlog
            SCFMIND(ISPC) = 9
            SCFTOPD(ISPC) = 7
          ELSE                                  ! Hardwood sawlog
            SCFMIND(ISPC) = 11
            SCFTOPD(ISPC) = 9
          END IF
        END IF

14710 CONTINUE
      IF(LKECHO)WRITE(JOSTND,14711) KEYWRD
14711    FORMAT (/A8, '   KEYWORD HAS BEEN REQUESTED.  '
     >   'ALL CUBIC FOOT VOLUME COMPUTATIONS WILL BE BASED ON FIA NSVB '
     >   'METHODOLOGIES.',/,
     >   '           NO OTHER USER REQUESTS TO ALTER CUBIC FOOT ' 
     >   'VOLUME ESTIMATES WILL BE PERMITTED.')
      GOTO 10
```

**base\volkey.f** - Prevention of conditionally, or mid simulation changes to merchantibility specifications if NVB has been evoked via addtion of check for LFIANVB flag.

**bin\FVSxx_sourceList.txt** - Inclusion of new files to source

**vbase\initre.f** Added LFIANVB keyword.  Added logic to prevent cubic foot volume or defect modification if LFIANVB active.  Added `ECOREG` and `ISTDORG` to STNDINFO keyword.

**xx\nvb\nvbeqdef.f** - FIA NVB Equation generation subroutine.

* Makes use of `ECOREG`, `ISTATE`, `ISTDORG` as well as FIA species code to build appropriate NVB equation.

**xx\nvb\nvb_region_check.f** - validatation of input ecoregion code

### II(a). Addtion of Required FIA Input Variables

FIA computation requires the addtion of three (3) additional variables, not currently tracked by FVS. `CULL`, `DECAYCD`, and `WDLDSTEM`

#### II(a). Impact on users

Users are encouraged to input these values in the FVS_TreeInit tables if using FIANVB methods.

#### II(a). Files Modified

**common\ARRAYS.F77** - Added variables:

|    Variable       | Data Type | Description |
|-------------------|-----------|-------------|
| `CULL(MAXTRE)`    |   `real`  |             |
| `DECAYCD(MAXTRE)` | `integer` |             |
| `WDLDSTEM(MAXTRE)`| `integer` | number of stems in multi-stem colonal species |

**Added variables and associated logic to:**

* **dbsqlite\dbstreein.f**
* **base\apisubs.f**
* **base\comprs.f**
* **base\triple.f**
* **base\intree.f**
* **base\tremov.f**
* **dbsqlite\dbstreesin.f**
* **pg\getstd.f**
* **pg\putstd.f**
* **vv\esuckr.f**
* **vv\estab.f**
* **\vols.f**

* **vdbsqlite\dbsstandin.f** - Added read in for cull, decay, woodland stem count, and stand origin as well as converting from CECOREG format of '313Ah' to format of '310 '

Modications of volume calls to support FIAVBC required NVEL inputs

* **fire\base\fmcrbout.f**
* **fire\base\fmcwd.f**
* **fire\base\fmdout.f**
* **fire\base\fmevmon.f**
* **fire\base\fmscut.f**
* **fire\base\fmsvol.f**
* **fire\base\fmcrowe.f**
* **fire\base\fmcfmd.f**

Additional code to maintain existing computaions for eastern variants

* **fire\base\fmeff.f**
* **fire\base\fmfmout.f**

### II(b). Addtion of FIA Biomass and Carbon Output Variables

Part of the FIA NVB intention was to incorporate and report FIA carbon and biomass measures, including: Above ground biomass / carbon, merchantable biomass / carbon, cubic sawlog biomass / carbon, foliar biomass / carbon.

#### II(b). Impact on users

Outputs for FIA carbon and biomass are available in several new tables (FVS_FIAVBC_Summary, FVS_FIAVBC_TreeList, FVS_FIAVBC_CutList, FVS_FIAVBC_ATRTList) as well as event monitor variables and inventory statistic tables

#### II(b). Files Modified

**common\ARRAYS.F77** - Added variables:

|    Variable           | Data Type  | Description |
|-----------------------|------------|-------------|
| `ABVGRD_BIO(MAXTRE)`  |   `real`   |             |
| `ABVGRD_CARB(MAXTRE)` |   `real`   |             |
| `MERCH_BIO(MAXTRE)`   |   `real`   |             |
| `MERCH_CARB(MAXTRE)`  |   `real`   |             |
| `CUBSAW_BIO(MAXTRE)`  |   `real`   |             |
| `CUBSAW_CARB(MAXTRE)` |   `real`   |             |
| `FOLI_BIO(MAXTRE)`    |   `real`   |             |
| `FOLI_CARB(MAXTRE)`   |   `real`   |             |

**common\OUTCOM.F77** - Added variables:

|    Variable           | Data Type  | Description |
|-----------------------|------------|-------------|
| `OAGBIOCUR(7)`        |   `real`   | Current above ground biomass w/ distribution (lbs)            |
| `OAGBIOREM(7)`        |   `real`   | Above ground biomass (wood & bark) removed in thinning w/ distribution (lbs)           |
| `OAGCARBCUR(7)`       |   `real`   | Current amount of carbon in above ground biomass (wood & bark) w/ distribution (lbs)             |
| `OAGCARBREM(7)`       |   `real`   | Amount of carbon in above ground biomass (wood & bark) removed in thinning w/ distribution            |
| `OCSAWBIOCUR(7)`      |   `real`   | Amount of biomass in cubic sawtimber w/ distribution (lbs)            |
| `OCSAWBIOREM(7)`      |   `real`   | Amount of biomass of cubic sawtimber removed in thinning w/ distribution (lbs)            |
| `OCSAWCARBCUR(7)`     |   `real`   | Amount of carbon in cubic sawtimber w/ distribution (lbs)            |
| `OCSAWCARBREM(7)`     |   `real`   | Amount of carbon in cubic sawtimber removed w/ distribution (lbs)            |
| `OMERBIOCUR(7)`       |   `real`   | Current amount of biomass in merchantable portion of stem w/ distribution (lbs) |
| `OMERBIOREM(7)`       |  `real`    | Amount of biomass in merchantable portion of stem removed w/ distribution (lbs) |
| `IOAGBIO(4)`:`OSAGBIO(4)` | `character`:`real` | Above ground biomass stand composition arrays |
| `IOAGBIOREM(4)`:`OSAGBIOREM(7)` |  `character`:`real` | Abouve ground biomass removed stand composition arrays |
| `IOAGCARB(4)`:`OSAGCARB(4)` | `character`:`real` | Above ground carbon stand composition arrays |
| `IOAGCARBREM(4)`:`OSAGCARBREM(4)` | `character`:`real` | Above ground carbon removed stand composition arrays |
| `IOMERBIO(4)`:`OSMERBIO(4)` | `character`:`real` | Cubic foot merchantable biomass stand composition arrays |
| `IOMERBIOREM(4)`:`OSMERBIOREM(4)` | `character`:`real` | Cubic merchantable biomass removed stand composition arrays |
| `IOMERCARB(4)`:`OSMERCARB(4)` | `character`:`real` | Cubic merchantable carbon stand composition arrays |
| `IOMERCARBREM(4)`:`OSMERCARBREM(4)` | `character`:`real` | Amount of carbon in cubic merchantable volume removed, stand composition arrays |
| `IOCSAWBIO(4)`:`OSCSAWBIO(4)` | `character`:`real` | Biomass in cubic sawtimber stand composition arrays |
| `IOCSAWBIOREM(4)`:`OSCSAWBIOREM(4)` | `character`:`real` | Amount of biomass in cubic sawtimber removed, stand composition arrays |
| `IOCSAWCARB(4)`:`OSCSAWCARB(4)` | `character`:`real` | Amount of carbon in cubic sawtimber, stand composition arrays |
| `IOCSAWCARBREM(4)`:`OSCSAWCARBREM(4)` | `character`:`real` | Amount of carbon contained in removed cubic sawtimber, stand composition arrays |

**Added variables and associated logic to:**

* **dbsqlite\dbstreein.f**
* **base\apisubs.f**
* **base\comprs.f**
* **base\gradd.f**
* **base\triple.f**
* **base\intree.f**
* **base\tremov.f**
* **base\triple.f**
* **common\OUTCOM.F77**
* **pg\getstd.f**
* **pg\putstd.f**
* **vv\esuckr.f**
* **vv\estab.f**
* **\vols.f**

### II(c). Addition of FIAVBC Reporting

To faciliate reporting of FIAVBC volume, carbon, and biomass measures, additional reports and keywords have been added to the DATABASE extension.

* VBCSUMDB - Generates the FVS_FIAVBC Summary table of stand level attributes including: Total cubic foot volume (TCuFt), merchantable cubic foot volume (MCuFt), sawlog cubic foot volume (SCuFt), above ground biomass (AbvGrdBio), biomass contained in merchantable cubic volume (MerchBio), biomass contained in sawlog cubic volume (SawBio), foliar biomass (FoliBio), above ground carbon (AbvGrdCarb), carbon in merchantable cubic volume (MerchCarb), carbon contained in sawlog cubic volume (SawCarb), foliar carbon (FoliCarb), as well as removal totals for listed metrics.

* VBCTRLDB - Generates the FVS_FIAVBC_Treelist table of tree level attributes including: SpeciesFVS, SpeciesPlants, SpeciesFIA, TPA, MortTPA, DBH, Ht, EstHt, TruncHt, PctCr, Cull, WdldStem, DecayCd, CarbFrac, TCuFt, MCuFt, SCuFt, AbvGrdBio, MerchBio, SawBio, FoliBio, AbvGrdCarb, MerchCarb, SawCarb, FoliCarb

* VBCCUTDB - Generates the FVS_FIAVBC_Cutlist table of tree level attributes.  Includes all attributes listed for FVS_FIAVBC_Treelist, but for cut trees.

* VBCATRDB - Generates the FVS_FIAVBC_ATRTlist (after treatment) table of tree level attributes.  Includes all attributes listed for FVS_FIAVBC_Treelist, but for residual (after treatment) trees.

#### II(c). Impact on users

The FIAVBC keyword must also be requested for users to generate these FIAVBC centric lists.

```
*FIAVBC Outputs
FIAVBC
DATABASE
VBCSUMDB
VBCTRLDB
VBCCUTDB
VBCATRDB
END
```

It is important to note that FIAVBC estimates of biomass and carbon are **independant of FFE** computation of biomass and carbon, and thus unlikely to match in value reported.

#### II(c). Files Modified

**base\fvs.f** - Call to DBS_FIAVBC_TRLS to generate FVS_FIAVBC_Treelist Table

**dbsqlite\DBSCOM.F77** - Addition of logical flags for generation of FIAVBC centric reports

New files:

* **dbsqlite\dbs_fiavbc_atrtls.f**
* **dbsqlite\dbs_fiavbc_cutlst.f**
* **dbsqlite\dbs_fiavbc_trls.f**
* **vsbqlite\dbscarbbiosumry.f**

**dbsqlite\dbsin.f** - Added new keywords and control logic for new FIAVBC centric reports

### III. Expansion of Base Keyword Field Length

In order to accommodate the need to track additional common block variables, as well as provide access to the new cubic foot sawtimber merchantibility specification in a convient manner, that was logical belong to existing base model keywords, but where those keyword field were already completely utilized, the base keyword field capacity has been expanded from 8 to 12.

#### III. Impact on users

Existing addfiles, KCP's, keyfiles, and keyword inputs will still function as expected without any impact on the user.

In addtion to the existing keyword fields, the STDINFO keyword can now be used to define the EcoDivion code for the location (field 8), as well as the stand origin (field 9, set to '1' for plantation, default of '0', natural).

#### III. Files Modified

Expansion of arrays from 7 to 12 to support increased filed limit.

**base\evif.f**
**base\evtact.f**
**base\evtact.f**  
**base\evusrv.f**
**base\exbgc.f**
**base\exbrus.f**
**base\excov.f**
**base\exdfb.f**
**base\exfert.f**
**base\exmist.f**
**base\exmpb.f**
**base\exrd.f**
**base\ffin.f**
**base\keydmp.f**
**base\keyopn.f**
**base\keyrdr.f**
**base\ksstag.f**
**base\opnewc.f**
**base\sdefet.f**
**base\sdefln.f**
**base\spdecd.f**
**base\svkey.f**
**base\volkey.f**
**clim\base\clin.f**
**covr\cvin.f**
**dbs\dbsin.f**
**dfb\dfbin.f**
**dfb\dfbincr.f**
**dftm\dftmin.f**
**econ\ecin.f**
**lpmpb\mpbin.f**
**mistoe\misin.f**
**vorganon\orin.f**
**wpbr\brin.f**
**wsbwe\bwein.f**
**wsbwe\bwekdp.f**
**wsbwe\bwekrd.f**
**wwpb\bmin.f**
**wwpb\bmppin.f**

**vbase\initre.f** -

* Added assignment of common block variable `ECOREG` based on field 8, and `ISTDORG` based on field 9 of the STDINFO keyword.  Added variables to STDINFO reporting output.

* Added assignment of common block variables `SCFMIND` as field 8, `SCFTOPD` as field 9,
and `SCFSTMP` as field 10, to VOLUME keyword, for all species, group, single species, combinations, as well as text ouput notifiction.

```FORTRAN
        IF (LNOTBK(8)) SCFMIND(IGSP) = ARRAY(8)
        IF (LNOTBK(9)) SCFTOPD(IGSP) = ARRAY(9) 
        IF (LNOTBK(10)) SCFSTMP(IGSP) = ARRAY(10)
        ILEN=ISPGRP(IGRP,92)
        ...
        IF(LKECHO)WRITE(JOSTND,4534) KEYWRD,KARD(2)(1:ILEN),
     &    IGSP,DBHMIN(IGSP),TOPD(IGSP),STMP(IGSP),FRMCLS(IGSP),
     &    SCFMIND(IGSP),SCFTOPD(IGSP),SCFSTMP(IGSP)
```

**base\errgro.f** - Added error number 42, at LABEL 5200 as part of user warning of improper keyword field input, associted with `STDINFO` `ISTDORG` input validation

### IV. Ability to define sawlog cubic foot specifications from VOLUME keyword input

The ability to populate `SCFMIND(I)`, `SCFTOPD(I)`, `SCFSTMP(I)` through VOLUME keyword

#### IV. Impact on Users

User's are able to indepently set sawlog cubic foot specifications for `SCFMIND(I)`, `SCFTOPD(I)`, and `SCFSTMP(I)`

#### IV. Files Modified

**base\volkey.f** Added logic for conditional setting of `SCFMIND`, `SCFTOPD`, and `SCFSTMP` specifications, cooresponding to field positions 8, 9, and 10 respectively.

**vbase\initre.f** - Added logic for input of `SCFMIND`, `SCFTOPD`, and `SCFSTMP` specifications, cooresponding to field positions 8, 9, and 10 respectively.

### V. Addition of New Event Monitor Variables

Additional event monitor variables were added to assist in tracking sawtimber cubic foot values as well as carbon and biomass values.


|  Variable  |  Code  |            Description                          |
|------------|--------|-------------------------------------------------|
| `BSCUFT`   |  120   | Before thin sawlog cubic foot volume            |
| `ASCUFT`   |  220   | After thin sawlog cubic foot volume             |
| `RSCUFT`   |  221   | Removed sawlog cubic foot volumes               |
| `BABVBIO`  |  151   | Before thin above ground biomass                |
| `BMERBIO`  |  152   | Before thin merchantable (cubic volume) biomass |
| `BSAWBIO`  |  153   | Before thin cubic sawtimber biomass             |
| `BFOLBIO`  |  154   | Before thin foliage biomass                     |
| `BABVCRB`  |  155   | Before thin above ground carbon                 |
| `BMERCRB`  |  156   | Before thin merchantable carbon                 |
| `BSAWCRB`  |  157   | Before thin cubic sawlog carbon                 |
| `BFOLCRB`  |  158   | Before thin foliage carbon                      |
| `AABVBIO`  |  222   | After thin above ground biomass                 |
| `RABVBIO`  |  223   | Removed above ground biomass                    |
| `AMERBIO`  |  224   | After thin merchantable biomass                 |
| `RMERBIO`  |  225   | Removed merchantable biomass                    |
| `ASAWBIO`  |  226   | After thin cubic sawlog biomass                 |
| `RSAWBIO`  |  227   | Removed cubic sawlog biomass                    |
| `AABVCRB`  |  228   | After thin above ground carbon                  |
| `RABVCRB`  |  229   | Removed above ground carbon                     |
| `AMERCRB`  |  230   | After thin merchantable carbon                  |
| `RMERCRB`  |  231   | Removed merchantable carbon                     |
| `ASAWCRB`  |  232   | After thin cubic sawlog carbon                  |
| `RSAWCRB`  |  233   | Removed cubic sawlog carbon                     |

#### V. Impact on Users

Users have access to an additional 23 event monitor variables reporting a variety of before thining, removed, and residual values for volume, carbon, and biomass outputs.

#### V. Files Modified

**base\algkey.f** -

* Expansion of the N6, N7 parameters
* Added variables to relevant CTAB# arrays (CTAB6, CTAB7)
* Added relevant codes to IOP# arrays (IOP6, IOP7)

**base\apisubs.f** - Added cases for variables to subroutine `fvsEvmonAttr`, in the form of:

```FORTRAN
      case ("VARAIBLE_NAME")
        iv=CODE
```

**base\fvs.f**  added computaion of total and percentile distribution for FIAVBC biomass and carbon variables

**vbase\EVTSTV.f** -

* Added / defined new EM variables to index
* Assigned to TSTV# arrays:
  * `TSTV1(20)=OSCCUR(7)/GROSPC`
  * `TSTV1(51)=OAGBIOCUR(7)/GROSPC/2000`
  * `TSTV1(52)=OMERBIOCUR(7)/GROSPC/2000`
  * `TSTV1(53)=OCSAWBIOCUR(7)/GROSPC/2000`
  * `TSTV1(54)=OFOLIBIO(7)/GROSPC/2000`
  * `TSTV1(55)=OAGCARBCUR(7)/GROSPC/2000`
  * `TSTV1(56)=OMERCARBCUR(7)/GROSPC/2000`
  * `TSTV1(57)=OCSAWCARBCUR(7)/GROSPC/2000`
  * `TSTV1(58)=OFOLICARB(7)/GROSPC/2000`
  * `TSTV2(21)=OSCREM(7)/GROSPC`
  * `TSTV2(23)=OAGBIOREM(7)/GROSPC`
  * `TSTV2(29)=OAGCARBREM(7)/GROSPC`
  * `TSTV2(25)=OMERBIOREM(7)/GROSPC`
  * `TSTV2(31)=OMERCARBREM(7)/GROSPC`
  * `TSTV2(27)=OCSAWBIOREM(7)/GROSPC`
  * `TSTV2(33)=OCSAWCARBREM(7)/GROSPC`
  * `TSTV2(22)=(OAGBIOCUR(7)-OAGBIOREM(7))/GROSPC/2000`
  * `TSTV2(28)=(OAGCARBCUR(7)-OAGCARBREM(7))/GROSPC/2000`
  * `TSTV2(24)=(OMERBIOCUR(7)-OMERBIOREM(7))/GROSPC/2000`
  * `TSTV2(30)=(OMERCARBCUR(7)-OMERCARBREM(7))/GROSPC/2000`
  * `TSTV2(26)=(OCSAWBIOCUR(7)-OCSAWBIOREM(7))/GROSPC/2000`
  * `TSTV2(32)=(OCSAWCARBCUR(7)-OCSAWCARBREM(7))/GROSPC/2000`
  * `TSTV2(34)=((OFOLIBIO(7)-OFOLIBIOREM(7))/GROSPC)/2000`
  * `TSTV2(36)=((OFOLICARB(7)-OFOLICARBREM(7))/GROSPC)/2000`

  **common\OPCOM.F77** - expansion of TSTV1, TSTV2, TSTV3 arrays to accomodate new EM Variables

### VI. Additional Tables, Existing Table Additions, and Table Standardization

During development several opportunites arose where FVS staff determined the addition of other new tables, additions to existing tables, or table standarization was warranted.  

* New Table Addition: FVS_InvReference - a species level table describing the internal parameter settings for variables during a simulation.  Attributes include: SpeciesNum (interal variant specific sequential numeric value assigned to a species), SpeciesFVS, SpeciesPlants, SpeciesFIA, FormClass, SDIMax, SiteIndex, CFVolEq, CFMinDBH, CFTopDia, CFStump, CFSawMinDBH, CFSawTopDia, CFSawStump, BFVolEq, BFMinDBH, BFTopDia, BFStump

* Additions to existing tables:
  * Inventory Statistics tables (VS_Stats_Species, FVS_Stats_Stands) has been restructured and additions made.  Will now report the following: 'Trees / Acre', 'Basal Area / Acre', 'Cubic Feet / Acre', 'Board Feet / Acre', AbvGrd Biomass / Acre', 'AbvGrd Carb / Acre'

* Table Standardization
  * Reporting of site index and Max SDI was standardized to provide consistancy in reporting across FVS

#### VI. Impact on Users

Users should be aware of changes to tables with regard to volume outputs, elimination of *_East tables, and addition of FIAVBC centric tables

#### VI. Files Modified

**..\dgdriv.f** - Site index standardization

**base\fvs.f** - Call to DBSREFERENCE to generate FVS_InvReference Table

**base\grincr.f** - Standardization of MaxSDI output

**base\stats.f** - Restructure of existing outputs and addition of above ground biomass and carbon computation and output

**dbsqlite\dbsstats.f**  

**vbase\initre.f** - Standardization of site index reporting

**vdbsqlite\dbsreference** - Provides FVS_InvReference table

### VII. Expansion and standardization of SPMCDBH

The SPMCDBH function has been standardized and expanded.  

#### VII. Impact on Users

* Arguement #1 to SPMCDBH
  * Value of 3 = Total cubic foot volume for **ALL** variants
  * Value of 4 = Merchantable board foot volumes for **ALL** variants
  * Value of 9 = Merchantable cubic foot volumes for **ALL** variants
  * Value of 15 = Sawlog cubic foot volumes for **ALL** variants (only populates in western variants when FIAVBC has been activated)

#### VII. Files Modified

**base\evldx.f**  

### VIII. Updates to Testing .save Files

* **Most Variants** - Updated .save files to reflect the new standard columns for sawlog cubic foot or additional outputs for biomass and carbon statistics.

* **CR Variant** - Noted volume differences in testing.  These volume differences can be attributed to the following:
  * Use of NVB equations as defaults for some species in CR
  * NVB Equations make use of crown ratio, which is now being passed to NVEL when previous FVS versions simply passed a '0'
  * NVB equations can make use of broken top height information which is now being passed to NVEL when previous versions of FVS simply passed a '0'
  * Since NVB equations can make use of broken top heights, the FVS topKillCF routines are no longer needed and bypassed with NVB equations

  In manual testing the volume returns from NVEL matched previous FVS releases when crown ratio and broken top heights we set to '0'

  * **CS Variant** - 
